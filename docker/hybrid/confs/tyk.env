### =============================================================================
### TYK HYBRID GATEWAY ENVIRONMENT CONFIGURATION
### =============================================================================
### This configuration is for Hybrid Gateway connecting to Tyk Cloud MDCB
### Default values are set for DEVELOPMENT environments. Comments describe PRODUCTION or PERFORMANCE tuning.
### =============================================================================

### -----------------------------------------------------------------------------
### GENERAL & CONNECTIVITY
### -----------------------------------------------------------------------------
TYK_GW_LISTENADDRESS= # Leave empty to listen on all interfaces, or set specific IP
TYK_GW_LISTENPORT=8080
TYK_GW_SECRET=352d20ee67be67f6340b4c0605b044b7 # SECURITY: Change to a strong 32+ character string for production (must match control plane)
TYK_GW_NODESECRET=352d20ee67be67f6340b4c0605b044b7 # SECURITY: Change to a strong 32+ character string for production (must match control plane)
TYK_GW_HOSTNAME= # PROD: Set to a domain name
TYK_GW_ENABLECUSTOMDOMAINS=true
TYK_GW_ALLOWINSECURECONFIGS=true
TYK_GW_LOGLEVEL=info # PROD: Set to "error" to reduce log volume
TYK_GW_ACCESSLOGS_ENABLED=false
TYK_GW_GLOBALSESSIONLIFETIME=100 # in seconds. PROD: Adjust based on security requirements.

### -----------------------------------------------------------------------------
### STORAGE CONFIGURATION (Redis)
### -----------------------------------------------------------------------------
TYK_GW_STORAGE_TYPE=redis
TYK_GW_STORAGE_ADDRS=tyk-redis:6379 # PROD: Use Redis Cluster e.g. ["server1:6379","server2:6380","server3:6381"]
TYK_GW_STORAGE_USERNAME=
TYK_GW_STORAGE_PASSWORD=
TYK_GW_STORAGE_DATABASE=0
TYK_GW_STORAGE_MAXIDLE=3000
TYK_GW_STORAGE_MAXACTIVE=5000
TYK_GW_STORAGE_ENABLECLUSTER=false # PROD/PERFORMANCE: Set to true for Redis Cluster (high availability and performance)
TYK_GW_STORAGE_USESSL=false # PROD: Set to true for secure Redis connections
TYK_GW_CACHESTORAGE_MAXACTIVE=2000 # PPROD/PERFORMANCE: Set to a higher value if you are expecting more traffic.
# TYK_GW_STORAGE_SSLINSECURESKIPVERIFY=false # PROD: Keep false to validate Redis SSL certificates
# TYK_GW_STORAGE_TIMEOUT= # Connection timeout in seconds. Adjust based on network latency (e.g. 15)

### -----------------------------------------------------------------------------
### HYBRID MODE - MDCB CONNECTION (Control Plane)
### -----------------------------------------------------------------------------
TYK_GW_SLAVEOPTIONS_USERRPC=true
TYK_GW_SLAVEOPTIONS_CONNECTIONSTRING=your-mdcb.cloud-ara.tyk.io:443 # REQUIRED: Replace with your MDCB endpoint from Tyk Cloud Console
TYK_GW_SLAVEOPTIONS_USESSL=true
TYK_GW_SLAVEOPTIONS_SSLINSECURESKIPVERIFY=true # PROD: Set to false if using proper SSL certificates
TYK_GW_SLAVEOPTIONS_RPCKEY= # REQUIRED: Your Organization ID from Tyk Cloud Console
TYK_GW_SLAVEOPTIONS_APIKEY= # REQUIRED: Your Dashboard User API Key from Tyk Cloud Console
TYK_GW_SLAVEOPTIONS_GROUPID= # REQUIRED: Gateway Group ID to identify this cluster (enables API events)
# TYK_GW_SLAVEOPTIONS_SYNCHRONISERENABLED=false # Set to true to enable periodic synchronization
# TYK_GW_SLAVEOPTIONS_KEYSPACESYNCINTERVAL=10 # Seconds between synchronization checks (if synchroniser enabled)

### -----------------------------------------------------------------------------
### POLICY CONFIGURATION (RPC Mode for Hybrid)
### -----------------------------------------------------------------------------
TYK_GW_POLICIES_POLICYSOURCE=rpc # Must be "rpc" for hybrid gateways (policies come from MDCB)
TYK_GW_POLICIES_POLICYRECORDNAME=tyk_policies # Policy record name in RPC mode
TYK_GW_POLICIES_ALLOWEXPLICITPOLICYID=true

### -----------------------------------------------------------------------------
### AUTHENTICATION OVERRIDE (Required for Hybrid Mode)
### -----------------------------------------------------------------------------
TYK_GW_AUTHOVERRIDE_FORCEAUTHPROVIDER=true
TYK_GW_AUTHOVERRIDE_AUTHPROVIDER_STORAGEENGINE=rpc

### -----------------------------------------------------------------------------
### ANALYTICS CONFIGURATION
### Enables analytics and uses Redis as temp storage for Tyk Pump
### -----------------------------------------------------------------------------
TYK_GW_ENABLEANALYTICS=true
TYK_GW_USEREDISLOG=true # When true, real-time Gateway log view appear in the Dashboard (requires same Redis instance as the dashboard)
TYK_GW_ENABLESEPERATEANALYTICSSTORE=false # PROD/PERFORMANCE: Set to true and use dedicated Redis Cluster for analytics
TYK_GW_ANALYTICSSTORAGE_TYPE=redis
TYK_GW_ANALYTICSSTORAGE_ADDRS=tyk-redis:6379 # PROD: Use separate Redis cluster e.g. ["analytics-redis1:6379","analytics-redis2:6380"]
TYK_GW_ANALYTICSSTORAGE_USERNAME=
TYK_GW_ANALYTICSSTORAGE_PASSWORD=
TYK_GW_ANALYTICSSTORAGE_DATABASE=0
TYK_GW_ANALYTICSSTORAGE_MAXIDLE=3000
TYK_GW_ANALYTICSSTORAGE_MAXACTIVE=5000
TYK_GW_ANALYTICSSTORAGE_ENABLECLUSTER=false # PROD/PERFORMANCE: Set to true for Redis Cluster
TYK_GW_ANALYTICSSTORAGE_USESSL=false # PROD: Set to true for secure analytics Redis connections
TYK_GW_ANALYTICSCONFIG_TYPE=
TYK_GW_ANALYTICSCONFIG_IGNOREDIPS=[]
TYK_GW_ANALYTICSCONFIG_ENABLEDETAILEDRECORDING=true # PROD: Set to false - increases storage and resource usage (use for debugging only)
TYK_GW_ANALYTICSCONFIG_ENABLEGEOIP=false # If true, set TYK_GW_ANALYTICSCONFIG_GEOIPDBLOCATION e.g /opt/tyk-gateway/databases/GeoLite2-Country.mmdb
TYK_GW_ANALYTICSCONFIG_NORMALISEURLS_ENABLED=true
TYK_GW_ANALYTICSCONFIG_NORMALISEURLS_NORMALISEUUIDS=true
TYK_GW_ANALYTICSCONFIG_NORMALISEURLS_NORMALISENUMBERS=true
TYK_GW_ANALYTICSCONFIG_NORMALISEURLS_CUSTOM=[]
# TYK_GW_ANALYTICSCONFIG_STORAGEEXPIRATIONTIME= # default 60, Time in seconds before analytics records expire if they are not processed
# TYK_GW_ANALYTICSCONFIG_ENABLEMULTIPLEANALYTICSKEYS=true # PROD/PERFORMANCE: set to true, Enables sharding the analytics records in multiple analytics keys

### -----------------------------------------------------------------------------
### KEY HASHING & SECURITY
### -----------------------------------------------------------------------------
TYK_GW_ALLOWMASTERKEYS=false
TYK_GW_HASHKEYS=true
TYK_GW_HASHKEYFUNCTION=murmur64 # PROD: Consider sha256 for stronger hashing
TYK_GW_ENABLEHASHEDKEYSLISTING=true
TYK_GW_MINTOKENLENGTH=32 # Minimum length for generated tokens. Should be 32 or higher.

### -----------------------------------------------------------------------------
### HTTP SERVER & TLS/SSL OPTIONS
### -----------------------------------------------------------------------------
TYK_GW_HTTPSERVEROPTIONS_USESSL=false # PROD: Set to true to enable SSL/TLS for Gateway
TYK_GW_HTTPSERVEROPTIONS_ENABLEWEBSOCKETS=true
TYK_GW_HTTPSERVEROPTIONS_SERVERNAME=tyk-gateway
TYK_GW_HTTPSERVEROPTIONS_MINVERSION=771 # TLS minimum version: 771 = TLS 1.2
TYK_GW_HTTPSERVEROPTIONS_FLUSHINTERVAL=0
TYK_GW_HTTPSERVEROPTIONS_ENABLEHTTP2=true
TYK_GW_HTTPSERVEROPTIONS_ENABLEPATHPREFIXMATCHING=true
TYK_GW_HTTPSERVEROPTIONS_ENABLEPATHSUFFIXMATCHING=true
TYK_GW_HTTPSERVEROPTIONS_ENABLESTRICTROUTES=true
TYK_GW_PROXYENABLEHTTP2=true
TYK_GW_PROXYSSLMINVERSION=771
# TYK_GW_PROXYSSLINSECURESKIPVERIFY=false # PROD: Keep false to validate upstream SSL certificates
# TYK_GW_HTTPSERVEROPTIONS_READTIMEOUT= # defaults to 120 seconds PROD: Set reasonable timeout to prevent resource exhaustion (e.g. 30)
# TYK_GW_HTTPSERVEROPTIONS_WRITETIMEOUT= # defaults to 120 seconds  PROD: Set reasonable timeout to prevent resource exhaustion (e.g. 30)
# TYK_GW_HTTPSERVEROPTIONS_MAXREQUESTBODYSIZE= # PROD: Set max request body size to prevent DDoS and memory issues (in bytes)
# TYK_GW_HTTPSERVEROPTIONS_SSLINSECURESKIPVERIFY=false # PROD: Keep false to validate SSL certificates
# TYK_GW_HTTPSERVEROPTIONS_SSLCERTIFICATES= # PROD: Path to SSL cert(s) or The ID assigned to and used to identify the cert in the Tyk Certificate Store

### -----------------------------------------------------------------------------
### UPTIME CHECKS
### -----------------------------------------------------------------------------
TYK_GW_HEALTHCHECK_ENABLEHEALTHCHECKS=true
TYK_GW_CLOSECONNECTIONS=false
TYK_GW_UPTIMETESTS_DISABLE=false
TYK_GW_UPTIMETESTS_CONFIG_ENABLEUPTIMEANALYTICS=true
TYK_GW_UPTIMETESTS_CONFIG_FAILURETRIGGERSAMPLESIZE=1 # The sample size before marking upstream as HostUp or HostDown event
TYK_GW_UPTIMETESTS_CONFIG_TIMEWAIT=30 # Interval in seconds between uptime checks
TYK_GW_SUPPRESSREDISSIGNALRELOAD=false

### -----------------------------------------------------------------------------
### MIDDLEWARE & PLUGINS
### -----------------------------------------------------------------------------
TYK_GW_TEMPLATEPATH=./templates
TYK_GW_TYKJSPATH=./js/tyk.js
TYK_GW_MIDDLEWAREPATH=./middleware
TYK_GW_APPPATH=./apps/
TYK_GW_ENABLEJSVM=true # PROD: Set to false if not using JavaScript middlewares
TYK_GW_COPROCESSOPTIONS_ENABLECOPROCESS=true # PROD: Set to false if not using gRPC or Python plugins
TYK_GW_HIDEGENERATORHEADER=false
TYK_GW_STREAMING_ENABLED=true # Enables Tyk Streams for event-driven APIs. Set to false if not using streaming.

### -----------------------------------------------------------------------------
### PERFORMANCE TUNING
### -----------------------------------------------------------------------------
# TYK_GW_CONTROLAPIPORT && TYK_GW_CONTROLAPIHOSTNAME= # PROD: Set to isolate Tyk Gateway API traffic from API traffic. https://tyk.io/docs/planning-for-production#change-your-control-port
# TYK_GW_PROXYCLOSECONNECTIONS=false # PROD/PERFORMANCE: Keep false to reuse connections to upstreams (keep-alive)
# TYK_GW_MAXIDLECONNSPERHOST=10000 # PROD/PERFORMANCE: Set high value (>=10000) for high-throughput scenarios
# TYK_GW_DRLTHRESHOLD=-1 # PROD/PERFORMANCE: Set to -1 to use DRL and disable fallback to hard-rate limit sync
# TYK_GW_DRLNOTIFICATIONFREQUENCY=1 # PROD/PERFORMANCE: Increase sync frequency for more accurate distributed rate limiting
# TYK_GW_ENABLENONTRANSACTIONALRATELIMITER=true # PROD/PERFORMANCE: ONLY IF USING Redis Rate limiting - Use non-transactional rate limiter for better performance